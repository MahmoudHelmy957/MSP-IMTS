/home/ouass/Test/MSP-IMTS/tPatchGNN/run_models.py
2025-09-19 02:40:56
run_models.py --dataset physionet --history 24 --quantization 1.0 --hid_dim 64 --te_dim 10 --node_dim 10 --nlayer 1 --tf_layer 1 --nhead 1 --batch_size 32 --lr 1e-3 --patience 60 --epoch 600 --seed 2 --gpu 0 --multi_scales 2,8 --multi_strides 2,8 --fusion concat
Namespace(multi_scales='2,8', multi_strides='2,8', fusion='concat', state='def', n=100000000, hop=1, nhead=1, tf_layer=1, nlayer=1, epoch=600, patience=60, history=24, patch_size=24, stride=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, save='experiments/', load=None, seed=2, dataset='physionet', quantization=1.0, model='tPatchGNN', outlayer='Linear', hid_dim=64, te_dim=10, node_dim=10, gpu='0', npatch=1, device=device(type='cuda'), PID=2927419, ndim=41)
- Epoch 000, ExpID 89895
Train - Loss (one batch): 0.00398
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00578, 0.00578, 0.07578, 0.04932, 12321554.68%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00619, 0.00619, 0.07764, 0.04942, 11319257.07%
Time spent: 20.43s
- Epoch 001, ExpID 89895
Train - Loss (one batch): 0.00611
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00555, 0.00555, 0.07430, 0.04745, 13634612.71%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00594, 0.00594, 0.07602, 0.04747, 12684422.21%
Time spent: 19.80s
- Epoch 002, ExpID 89895
Train - Loss (one batch): 0.00477
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00550, 0.00550, 0.07396, 0.04622, 13229107.63%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.00587, 0.00587, 0.07557, 0.04619, 12265369.99%
Time spent: 19.18s
- Epoch 003, ExpID 89895
Train - Loss (one batch): 0.00397
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00571, 0.00571, 0.07537, 0.04809, 12827701.65%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 2, 0.00587, 0.00587, 0.07557, 0.04619, 12265369.99%
Time spent: 17.41s
- Epoch 004, ExpID 89895
Train - Loss (one batch): 0.00563
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00494, 0.00494, 0.07004, 0.04249, 12484130.09%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00532, 0.00532, 0.07178, 0.04246, 11595049.15%
Time spent: 20.02s
- Epoch 005, ExpID 89895
Train - Loss (one batch): 0.00524
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00522, 0.00522, 0.07203, 0.04510, 10573171.64%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 4, 0.00532, 0.00532, 0.07178, 0.04246, 11595049.15%
Time spent: 17.99s
- Epoch 006, ExpID 89895
Train - Loss (one batch): 0.00401
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00447, 0.00447, 0.06663, 0.04014, 10471862.62%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.00484, 0.00484, 0.06834, 0.04025, 9567616.29%
Time spent: 20.43s
- Epoch 007, ExpID 89895
Train - Loss (one batch): 0.00393
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00492, 0.00492, 0.06998, 0.04345, 11821173.23%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.00484, 0.00484, 0.06834, 0.04025, 9567616.29%
Time spent: 18.22s
- Epoch 008, ExpID 89895
Train - Loss (one batch): 0.00412
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00528, 0.00528, 0.07243, 0.04664, 12424505.33%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.00484, 0.00484, 0.06834, 0.04025, 9567616.29%
Time spent: 17.37s
- Epoch 009, ExpID 89895
Train - Loss (one batch): 0.00583
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00470, 0.00470, 0.06833, 0.04144, 9989423.79%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.00484, 0.00484, 0.06834, 0.04025, 9567616.29%
Time spent: 17.71s
- Epoch 010, ExpID 89895
Train - Loss (one batch): 0.00432
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00477, 0.00477, 0.06887, 0.04284, 10854448.59%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 6, 0.00484, 0.00484, 0.06834, 0.04025, 9567616.29%
Time spent: 17.82s
- Epoch 011, ExpID 89895
Train - Loss (one batch): 0.00539
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00442, 0.00442, 0.06628, 0.04074, 11312639.47%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00477, 0.00477, 0.06785, 0.04077, 10437661.80%
Time spent: 19.89s
- Epoch 012, ExpID 89895
Train - Loss (one batch): 0.00467
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00490, 0.00490, 0.06984, 0.04464, 12049972.04%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00477, 0.00477, 0.06785, 0.04077, 10437661.80%
Time spent: 17.80s
- Epoch 013, ExpID 89895
Train - Loss (one batch): 0.00379
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00435, 0.00435, 0.06576, 0.03888, 10818735.50%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00470, 0.00470, 0.06735, 0.03887, 9892559.10%
Time spent: 20.22s
- Epoch 014, ExpID 89895
Train - Loss (one batch): 0.00348
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00481, 0.00481, 0.06920, 0.04462, 11918410.05%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 13, 0.00470, 0.00470, 0.06735, 0.03887, 9892559.10%
Time spent: 17.35s
- Epoch 015, ExpID 89895
Train - Loss (one batch): 0.00554
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00421, 0.00421, 0.06466, 0.03735, 9557948.49%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 15, 0.00457, 0.00457, 0.06630, 0.03738, 8731869.12%
Time spent: 19.77s
- Epoch 016, ExpID 89895
Train - Loss (one batch): 0.00410
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00428, 0.00428, 0.06519, 0.03855, 9707978.10%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 15, 0.00457, 0.00457, 0.06630, 0.03738, 8731869.12%
Time spent: 17.49s
- Epoch 017, ExpID 89895
Train - Loss (one batch): 0.00413
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00422, 0.00422, 0.06468, 0.03784, 8745546.40%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 15, 0.00457, 0.00457, 0.06630, 0.03738, 8731869.12%
Time spent: 17.48s
- Epoch 018, ExpID 89895
Train - Loss (one batch): 0.00315
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00419, 0.00419, 0.06450, 0.03779, 10918418.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 18, 0.00455, 0.00455, 0.06614, 0.03785, 9946841.23%
Time spent: 19.73s
- Epoch 019, ExpID 89895
Train - Loss (one batch): 0.00475
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00425, 0.00425, 0.06497, 0.03970, 10956070.58%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 18, 0.00455, 0.00455, 0.06614, 0.03785, 9946841.23%
Time spent: 17.62s
- Epoch 020, ExpID 89895
Train - Loss (one batch): 0.00593
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00479, 0.00479, 0.06898, 0.04411, 11491566.29%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 18, 0.00455, 0.00455, 0.06614, 0.03785, 9946841.23%
Time spent: 18.35s
- Epoch 021, ExpID 89895
Train - Loss (one batch): 0.00503
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00472, 0.00472, 0.06846, 0.04135, 9794687.51%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 18, 0.00455, 0.00455, 0.06614, 0.03785, 9946841.23%
Time spent: 17.73s
Traceback (most recent call last):
  File "/home/ouass/Test/MSP-IMTS/tPatchGNN/run_models.py", line 244, in <module>
    val_logs.append(_masked_metrics(pred, tgt, msk))
  File "/home/ouass/Test/MSP-IMTS/tPatchGNN/run_models.py", line 203, in _masked_metrics
    diff = (pred - tgt)[msk.bool()]
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

