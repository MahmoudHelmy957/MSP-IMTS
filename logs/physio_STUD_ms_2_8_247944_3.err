/home/ouass/Test/MSP-IMTS/tPatchGNN/run_models.py
2025-09-19 02:48:42
run_models.py --dataset physionet --history 24 --quantization 1.0 --hid_dim 64 --te_dim 10 --node_dim 10 --nlayer 1 --tf_layer 1 --nhead 1 --batch_size 32 --lr 1e-3 --patience 60 --epoch 600 --seed 3 --gpu 0 --multi_scales 2,8 --multi_strides 2,8 --fusion concat
Namespace(multi_scales='2,8', multi_strides='2,8', fusion='concat', state='def', n=100000000, hop=1, nhead=1, tf_layer=1, nlayer=1, epoch=600, patience=60, history=24, patch_size=24, stride=24, logmode='a', lr=0.001, w_decay=0.0, batch_size=32, save='experiments/', load=None, seed=3, dataset='physionet', quantization=1.0, model='tPatchGNN', outlayer='Linear', hid_dim=64, te_dim=10, node_dim=10, gpu='0', npatch=1, device=device(type='cuda'), PID=2927577, ndim=41)
- Epoch 000, ExpID 45015
Train - Loss (one batch): 0.00573
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00530, 0.00530, 0.07253, 0.04371, 10700945.79%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 0, 0.00561, 0.00561, 0.07373, 0.04358, 9923035.13%
Time spent: 20.31s
- Epoch 001, ExpID 45015
Train - Loss (one batch): 0.00427
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00500, 0.00500, 0.07047, 0.04262, 12857667.88%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00532, 0.00532, 0.07173, 0.04248, 12075695.82%
Time spent: 19.63s
- Epoch 002, ExpID 45015
Train - Loss (one batch): 0.00495
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00504, 0.00504, 0.07074, 0.04234, 10419781.93%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 1, 0.00532, 0.00532, 0.07173, 0.04248, 12075695.82%
Time spent: 17.72s
- Epoch 003, ExpID 45015
Train - Loss (one batch): 0.00446
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00462, 0.00462, 0.06771, 0.03914, 12257738.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00495, 0.00495, 0.06913, 0.03907, 11370390.91%
Time spent: 19.85s
- Epoch 004, ExpID 45015
Train - Loss (one batch): 0.00472
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00524, 0.00524, 0.07217, 0.04625, 12828517.23%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 3, 0.00495, 0.00495, 0.06913, 0.03907, 11370390.91%
Time spent: 17.54s
- Epoch 005, ExpID 45015
Train - Loss (one batch): 0.00612
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00434, 0.00434, 0.06562, 0.03878, 12132344.99%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00470, 0.00470, 0.06727, 0.03873, 11226189.18%
Time spent: 20.14s
- Epoch 006, ExpID 45015
Train - Loss (one batch): 0.00338
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00444, 0.00444, 0.06641, 0.03897, 11427109.62%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 5, 0.00470, 0.00470, 0.06727, 0.03873, 11226189.18%
Time spent: 17.92s
- Epoch 007, ExpID 45015
Train - Loss (one batch): 0.00342
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00430, 0.00430, 0.06533, 0.03661, 10447172.27%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00469, 0.00469, 0.06714, 0.03664, 9354099.70%
Time spent: 19.98s
- Epoch 008, ExpID 45015
Train - Loss (one batch): 0.00327
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00470, 0.00470, 0.06834, 0.04271, 10923765.29%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00469, 0.00469, 0.06714, 0.03664, 9354099.70%
Time spent: 16.79s
- Epoch 009, ExpID 45015
Train - Loss (one batch): 0.00625
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00528, 0.00528, 0.07246, 0.04518, 11989315.75%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00469, 0.00469, 0.06714, 0.03664, 9354099.70%
Time spent: 18.02s
- Epoch 010, ExpID 45015
Train - Loss (one batch): 0.00380
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00444, 0.00444, 0.06638, 0.03937, 9751128.80%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 7, 0.00469, 0.00469, 0.06714, 0.03664, 9354099.70%
Time spent: 17.64s
- Epoch 011, ExpID 45015
Train - Loss (one batch): 0.00451
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00427, 0.00427, 0.06511, 0.03735, 10287460.24%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 19.71s
- Epoch 012, ExpID 45015
Train - Loss (one batch): 0.00454
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00439, 0.00439, 0.06600, 0.03940, 11425522.20%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.80s
- Epoch 013, ExpID 45015
Train - Loss (one batch): 0.00319
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00436, 0.00436, 0.06581, 0.03854, 10037521.68%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.83s
- Epoch 014, ExpID 45015
Train - Loss (one batch): 0.00326
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00432, 0.00432, 0.06549, 0.03841, 9786219.98%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.72s
- Epoch 015, ExpID 45015
Train - Loss (one batch): 0.00445
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00432, 0.00432, 0.06546, 0.03669, 11335115.88%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.71s
- Epoch 016, ExpID 45015
Train - Loss (one batch): 0.00366
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00491, 0.00491, 0.06988, 0.04284, 9863373.58%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.15s
- Epoch 017, ExpID 45015
Train - Loss (one batch): 0.00446
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00428, 0.00428, 0.06517, 0.03812, 11040817.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 18.04s
- Epoch 018, ExpID 45015
Train - Loss (one batch): 0.00523
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00430, 0.00430, 0.06533, 0.03801, 11642389.40%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.81s
- Epoch 019, ExpID 45015
Train - Loss (one batch): 0.00428
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00437, 0.00437, 0.06592, 0.03941, 11114910.06%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 11, 0.00463, 0.00463, 0.06677, 0.03735, 9292612.20%
Time spent: 17.73s
- Epoch 020, ExpID 45015
Train - Loss (one batch): 0.00447
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00418, 0.00418, 0.06440, 0.03677, 10071092.53%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 20, 0.00454, 0.00454, 0.06606, 0.03680, 9020363.09%
Time spent: 19.99s
- Epoch 021, ExpID 45015
Train - Loss (one batch): 0.00533
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00418, 0.00418, 0.06445, 0.03810, 10165358.79%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 20, 0.00454, 0.00454, 0.06606, 0.03680, 9020363.09%
Time spent: 17.60s
- Epoch 022, ExpID 45015
Train - Loss (one batch): 0.00371
Val - Loss, MSE, RMSE, MAE, MAPE: 0.00441, 0.00441, 0.06619, 0.04055, 10187495.58%
Test - Best epoch, Loss, MSE, RMSE, MAE, MAPE: 20, 0.00454, 0.00454, 0.06606, 0.03680, 9020363.09%
Time spent: 17.86s
Traceback (most recent call last):
  File "/home/ouass/Test/MSP-IMTS/tPatchGNN/run_models.py", line 226, in <module>
    loss = ((pred - tgt)[msk.bool()] ** 2).mean()
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

